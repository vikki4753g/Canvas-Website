<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Canvas-Aware Website</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f7fa;
        }
        h1 {
            color: #0070d2;
        }
        .hidden { display: none; }
        .blocked { color: red; font-weight: bold; }
        button {
            padding: 10px 20px;
            font-size: 16px;
            background-color: #0070d2;
            border: none;
            color: white;
            cursor: pointer;
            border-radius: 4px;
            margin-top: 20px;
        }
        button:hover { background-color: #005fb2; }
    </style>
</head>
<body>
    <div id="content">
        <h1>Welcome to My Website</h1>
        <p id="message">This is your website content.</p>
        <button id="loginBtn">Login to Salesforce</button>
    </div>

    <div id="blockedMessage" class="hidden blocked">
        <h1>Access Denied</h1>
        <p>Your Salesforce UserId is not authorized to view this content.</p>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
        const allowedUserIds = [
            "005NS00000HHuDhYAL",
            "005NS00000JHnfiYAD"
        ];

        // Default: hide blocked message
        $('#blockedMessage').addClass('hidden');

        // Check if Canvas SDK is loaded (inside Salesforce Canvas)
        if (window.Sfdc && Sfdc.canvas && Sfdc.canvas.client) {
            const context = Sfdc.canvas.client.context || {};
            const userId = context.user ? context.user.userId : null;

            if (userId && allowedUserIds.includes(userId)) {
                // Allowed: show content
                $('#content').removeClass('hidden');
            } else {
                // Not allowed: hide content, show blocked message
                $('#content').addClass('hidden');
                $('#blockedMessage').removeClass('hidden');
            }

            // Handle login button inside Canvas
            $('#loginBtn').on('click', function() {
                Sfdc.canvas.client.publish(window.parent, 'openLoginExternally', {
                    url: 'https://login.salesforce.com'
                });
            });

        } else {
            // Not inside Canvas â†’ show content normally
            $('#content').removeClass('hidden');
            $('#blockedMessage').addClass('hidden');

            // Optional: Login button opens Salesforce login directly in new tab
            $('#loginBtn').on('click', function() {
                window.open('https://login.salesforce.com', '_blank');
            });
        }
    </script>
</body>
</html>
